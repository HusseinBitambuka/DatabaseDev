package BillionRow.data;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.*;

public class NoRegex {

    public static void main(String[] args) throws IOException {
        Map<String, Stats> data = new HashMap<>();
        long startTime = System.currentTimeMillis() / 1000;
        int numRow = 0;

        try (BufferedReader reader = new BufferedReader(
                new FileReader("/home/husseinbitambuka/Dev/DatabaseDev/BillionRow/data/measurements.txt"))) {

            String line;
            while ((line = reader.readLine()) != null) {
                numRow++;
                int sep = line.indexOf(';');
                String city = line.substring(0, sep);
                double temp = Double.parseDouble(line.substring(sep + 1));
                data.computeIfAbsent(city, e -> new Stats()).add(temp);
            }

            data.entrySet().stream()
                    .sorted(Map.Entry.comparingByKey())
                    .forEach(e -> System.out.println(e.getKey() + "=" + e.getValue()));

            long endTime = System.currentTimeMillis() / 1000;

            System.out.println("The challenge contains " + numRow + " rows, parsed and processed in "
                    + (endTime - startTime) + " seconds.");
        }
    }
}
/*
 * Messages -cp /home/husseinbitambuka/.config/Code/User/workspaceStorage/
 * 75735775e40eeb64579bda9928f08711/redhat.java/jdt_ws/DatabaseDev_f4f249b7/bin
 * BillionRow.data.NoRegex
 * Abha=-30.3/18.0/66.8
 * Abidjan=-28.1/26.0/75.9
 * Abéché=-21.5/29.4/77.0
 * Accra=-24.8/26.4/80.3
 * Addis Ababa=-33.0/16.0/67.4
 * Adelaide=-30.3/17.3/63.8
 * Aden=-18.9/29.1/77.5
 * Ahvaz=-22.4/25.4/78.1
 * Albuquerque=-32.8/14.0/65.7
 * Alexandra=-39.2/11.0/65.2
 * Alexandria=-31.4/20.0/72.4
 * Algiers=-30.3/18.2/68.1
 * Alice Springs=-38.0/21.0/73.3
 * Almaty=-41.9/10.0/59.7
 * Amsterdam=-41.6/10.2/62.9
 * Anadyr=-58.5/-6.9/43.5
 * Anchorage=-48.8/2.8/53.0
 * Andorra la Vella=-41.0/9.8/58.0
 * Ankara=-38.8/12.0/64.6
 * Antananarivo=-30.6/17.9/70.6
 * Antsiranana=-25.9/25.2/75.1
 * Arkhangelsk=-47.7/1.3/52.8
 * Ashgabat=-32.8/17.1/67.4
 * Asmara=-32.9/15.6/63.1
 * Assab=-21.2/30.5/78.3
 * Astana=-45.1/3.5/58.3
 * Athens=-29.7/19.2/69.2
 * Atlanta=-36.6/17.0/65.3
 * Auckland=-36.6/15.2/62.8
 * Austin=-36.6/20.7/69.5
 * Baghdad=-26.4/22.8/72.2
 * Baguio=-28.2/19.5/68.6
 * Baku=-33.3/15.1/64.8
 * Baltimore=-34.8/13.1/63.2
 * Bamako=-25.3/27.8/78.9
 * Bangkok=-23.5/28.6/77.9
 * Bangui=-23.4/26.0/76.5
 * Banjul=-22.3/26.0/75.5
 * Barcelona=-30.4/18.2/67.4
 * Bata=-28.3/25.1/74.5
 * Batumi=-35.7/14.0/67.2
 * Beijing=-39.9/12.9/61.4
 * Beirut=-28.9/20.9/70.8
 * Belgrade=-35.4/12.5/64.3
 * Belize City=-21.3/26.7/75.4
 * Benghazi=-33.3/19.9/71.3
 * Bergen=-39.9/7.7/57.3
 * Berlin=-39.4/10.3/58.6
 * Bilbao=-39.4/14.7/62.7
 * Birao=-22.0/26.5/73.6
 * Bishkek=-39.5/11.3/58.4
 * Bissau=-24.2/27.0/76.1
 * Blantyre=-31.3/22.2/75.2
 * Bloemfontein=-35.3/15.6/65.3
 * Boise=-39.9/11.4/58.3
 * Bordeaux=-33.5/14.2/65.9
 * Bosaso=-21.6/30.0/78.2
 * Boston=-40.5/10.9/63.0
 * Bouaké=-22.4/26.0/80.5
 * Bratislava=-46.9/10.5/61.7
 * Brazzaville=-25.3/25.0/75.9
 * Bridgetown=-26.7/27.0/75.9
 * Brisbane=-27.0/21.4/68.4
 * Brussels=-39.6/10.5/63.6
 * Bucharest=-35.1/10.8/61.6
 * Budapest=-39.9/11.3/60.5
 * Bujumbura=-24.8/23.8/73.6
 * Bulawayo=-37.1/18.9/70.9
 * Burnie=-36.2/13.1/64.9
 * Busan=-31.3/15.0/64.7
 * Cabo San Lucas=-26.8/23.9/73.7
 * Cairns=-27.5/25.0/74.3
 * Cairo=-28.0/21.4/70.0
 * Calgary=-49.5/4.4/56.5
 * Canberra=-33.8/13.1/63.1
 * Cape Town=-37.2/16.2/68.2
 * Changsha=-32.1/17.4/65.8
 * Charlotte=-33.6/16.1/68.2
 * Chiang Mai=-23.0/25.8/77.4
 * Chicago=-36.9/9.8/61.2
 * Chihuahua=-33.5/18.6/70.9
 * Chittagong=-24.1/25.9/74.1
 * Chișinău=-47.4/10.2/59.2
 * Chongqing=-34.1/18.6/66.4
 * Christchurch=-35.5/12.2/63.2
 * City of San Marino=-35.9/11.8/60.7
 * Colombo=-21.4/27.4/79.1
 * Columbus=-37.5/11.7/59.5
 * Conakry=-23.0/26.4/77.4
 * Copenhagen=-40.1/9.1/58.1
 * Cotonou=-27.0/27.2/77.3
 * Cracow=-45.5/9.3/60.9
 * Da Lat=-33.3/17.9/66.2
 * Da Nang=-30.1/25.8/78.5
 * Dakar=-26.9/24.0/70.7
 * Dallas=-32.2/19.0/67.5
 * Damascus=-33.2/17.0/70.8
 * Dampier=-22.9/26.4/73.5
 * Dar es Salaam=-22.4/25.8/73.4
 * Darwin=-26.5/27.6/77.3
 * Denpasar=-24.4/23.7/76.2
 * Denver=-39.7/10.4/59.9
 * Detroit=-47.7/10.0/62.1
 * Dhaka=-22.9/25.9/74.4
 * Dikson=-61.0/-11.1/38.0
 * Dili=-23.4/26.6/78.8
 * Djibouti=-24.0/29.9/84.7
 * Dodoma=-29.9/22.7/77.9
 * Dolisie=-22.3/24.0/75.9
 * Douala=-21.2/26.7/74.0
 * Dubai=-24.4/26.9/76.1
 * Dublin=-41.2/9.8/58.8
 * Dunedin=-44.7/11.1/60.4
 * Durban=-29.7/20.6/72.0
 * Dushanbe=-37.8/14.7/64.9
 * Edinburgh=-38.6/9.3/57.1
 * Edmonton=-46.3/4.2/52.1
 * El Paso=-31.9/18.1/66.8
 * Entebbe=-28.4/21.0/70.6
 * Erbil=-29.2/19.5/68.0
 * Erzurum=-44.0/5.1/53.8
 * Fairbanks=-54.6/-2.3/44.6
 * Fianarantsoa=-31.7/17.9/71.1
 * Flores, Petén=-33.3/26.4/76.1
 * Frankfurt=-38.1/10.6/62.8
 * Fresno=-35.0/17.9/66.6
 * Fukuoka=-31.5/17.0/69.6
 * Gaborone=-29.5/21.0/73.6
 * Gabès=-30.4/19.5/69.7
 * Gagnoa=-28.2/26.0/74.8
 * Gangtok=-35.3/15.2/69.3
 * Garissa=-22.4/29.3/80.1
 * Garoua=-22.1/28.3/80.0
 * George Town=-22.6/27.9/78.2
 * Ghanzi=-31.4/21.4/70.6
 * Gjoa Haven=-61.6/-14.4/36.8
 * Guadalajara=-29.3/20.9/71.3
 * Guangzhou=-25.7/22.4/77.9
 * Guatemala City=-25.7/20.4/69.1
 * Halifax=-44.7/7.5/57.5
 * Hamburg=-40.4/9.7/59.8
 * Hamilton=-38.5/13.8/65.1
 * Hanga Roa=-32.0/20.5/69.7
 * Hanoi=-28.7/23.6/76.6
 * Harare=-38.2/18.4/72.2
 * Harbin=-50.2/5.0/56.5
 * Hargeisa=-28.8/21.7/73.5
 * Hat Yai=-24.1/27.0/81.2
 * Havana=-24.8/25.2/77.2
 * Helsinki=-41.9/5.9/63.5
 * Heraklion=-30.7/18.9/66.5
 * Hiroshima=-32.4/16.3/71.0
 * Ho Chi Minh City=-22.5/27.4/75.1
 * Hobart=-37.7/12.7/67.7
 * Hong Kong=-24.5/23.3/76.2
 * Honiara=-23.9/26.5/73.9
 * Honolulu=-26.5/25.4/75.9
 * Houston=-27.6/20.8/72.7
 * Ifrane=-42.4/11.4/65.7
 * Indianapolis=-43.9/11.8/61.3
 * Iqaluit=-58.5/-9.3/38.2
 * Irkutsk=-48.3/1.0/48.8
 * Istanbul=-33.8/13.9/61.5
 * Jacksonville=-33.1/20.3/69.5
 * Jakarta=-23.1/26.7/75.3
 * Jayapura=-23.6/27.0/82.2
 * Jerusalem=-33.2/18.3/66.7
 * Johannesburg=-35.3/15.5/65.9
 * Jos=-29.5/22.8/72.8
 * Juba=-28.0/27.8/80.6
 * Kabul=-35.0/12.1/61.9
 * Kampala=-29.9/20.0/72.3
 * Kandi=-18.9/27.7/75.8
 * Kankan=-23.5/26.5/75.6
 * Kano=-22.2/26.4/76.8
 * Kansas City=-40.5/12.5/61.9
 * Karachi=-24.7/26.0/74.4
 * Karonga=-33.6/24.4/71.8
 * Kathmandu=-29.0/18.3/65.7
 * Khartoum=-23.6/29.9/79.2
 * Kingston=-19.4/27.4/74.3
 * Kinshasa=-25.1/25.3/77.4
 * Kolkata=-22.8/26.7/75.0
 * Kuala Lumpur=-23.8/27.3/74.2
 * Kumasi=-24.8/26.0/77.1
 * Kunming=-36.1/15.7/67.3
 * Kuopio=-47.1/3.4/55.3
 * Kuwait City=-22.9/25.7/74.8
 * Kyiv=-44.2/8.4/56.9
 * Kyoto=-33.5/15.8/64.2
 * La Ceiba=-22.1/26.2/81.9
 * La Paz=-31.8/23.7/71.1
 * Lagos=-20.0/26.8/76.6
 * Lahore=-25.7/24.3/75.3
 * Lake Havasu City=-25.7/23.7/72.3
 * Lake Tekapo=-42.2/8.7/59.5
 * Las Palmas de Gran Canaria=-25.7/21.2/70.3
 * Las Vegas=-27.6/20.3/74.1
 * Launceston=-38.0/13.1/61.2
 * Lhasa=-43.9/7.6/56.2
 * Libreville=-28.4/25.9/77.3
 * Lisbon=-32.9/17.5/69.7
 * Livingstone=-26.6/21.8/69.7
 * Ljubljana=-42.7/10.9/59.3
 * Lodwar=-22.9/29.3/79.6
 * Lomé=-25.5/26.9/76.8
 * London=-39.3/11.3/62.2
 * Los Angeles=-31.1/18.6/66.6
 * Louisville=-36.2/13.9/62.5
 * Luanda=-23.5/25.8/72.9
 * Lubumbashi=-31.7/20.8/71.5
 * Lusaka=-32.5/19.9/71.2
 * Luxembourg City=-42.6/9.3/58.8
 * Lviv=-43.9/7.8/54.9
 * Lyon=-42.6/12.5/62.1
 * Madrid=-36.2/15.0/68.0
 * Mahajanga=-21.8/26.3/78.8
 * Makassar=-21.7/26.7/75.3
 * Makurdi=-25.1/26.0/75.4
 * Malabo=-22.6/26.3/78.5
 * Malé=-25.0/28.0/81.5
 * Managua=-20.1/27.3/76.2
 * Manama=-29.2/26.5/84.0
 * Mandalay=-22.2/28.0/79.6
 * Mango=-20.8/28.1/78.1
 * Manila=-23.5/28.4/78.1
 * Maputo=-26.1/22.8/69.8
 * Marrakesh=-31.7/19.6/68.9
 * Marseille=-32.0/15.8/75.6
 * Maun=-26.4/22.4/71.4
 * Medan=-24.4/26.5/80.3
 * Mek'ele=-28.5/22.7/73.4
 * Melbourne=-31.6/15.1/64.5
 * Memphis=-31.8/17.2/66.8
 * Mexicali=-26.7/23.1/73.2
 * Mexico City=-31.2/17.5/67.0
 * Miami=-24.5/24.9/74.8
 * Milan=-35.2/13.0/62.0
 * Milwaukee=-42.8/8.9/57.1
 * Minneapolis=-41.0/7.8/54.4
 * Minsk=-47.1/6.7/55.1
 * Mogadishu=-22.0/27.1/78.4
 * Mombasa=-22.6/26.3/74.6
 * Monaco=-33.5/16.4/66.2
 * Moncton=-42.3/6.1/54.0
 * Monterrey=-30.1/22.3/71.5
 * Montreal=-44.7/6.8/59.9
 * Moscow=-45.9/5.8/54.1
 * Mumbai=-27.6/27.1/78.6
 * Murmansk=-50.7/0.6/50.2
 * Muscat=-23.5/28.0/76.8
 * Mzuzu=-33.3/17.7/68.1
 * N'Djamena=-21.6/28.3/74.8
 * Naha=-27.5/23.1/71.3
 * Nairobi=-31.2/17.8/66.6
 * Nakhon Ratchasima=-23.0/27.3/77.0
 * Napier=-34.1/14.6/65.2
 * Napoli=-34.6/15.9/62.5
 * Nashville=-34.5/15.4/64.4
 * Nassau=-23.7/24.6/70.8
 * Ndola=-27.7/20.3/76.5
 * New Delhi=-23.6/25.0/74.7
 * New Orleans=-30.4/20.7/73.4
 * New York City=-40.7/12.9/63.3
 * Ngaoundéré=-27.4/22.0/73.8
 * Niamey=-22.9/29.3/82.1
 * Nicosia=-32.6/19.7/73.3
 * Niigata=-33.9/13.9/67.5
 * Nouadhibou=-28.1/21.3/69.0
 * Nouakchott=-25.3/25.7/73.8
 * Novosibirsk=-45.2/1.7/51.1
 * Nuuk=-49.6/-1.4/47.3
 * Odesa=-37.4/10.7/64.0
 * Odienné=-24.0/26.0/77.0
 * Oklahoma City=-36.4/15.9/71.7
 * Omaha=-39.6/10.6/62.6
 * Oranjestad=-23.4/28.1/77.5
 * Oslo=-43.6/5.7/54.3
 * Ottawa=-44.7/6.6/55.7
 * Ouagadougou=-21.2/28.3/78.0
 * Ouahigouya=-23.0/28.6/80.3
 * Ouarzazate=-32.4/18.9/68.3
 * Oulu=-46.5/2.7/53.8
 * Palembang=-21.6/27.3/75.2
 * Palermo=-32.8/18.5/64.7
 * Palm Springs=-22.7/24.5/76.1
 * Palmerston North=-34.7/13.2/62.5
 * Panama City=-20.2/28.0/79.9
 * Parakou=-20.7/26.8/80.3
 * Paris=-37.5/12.3/61.9
 * Perth=-31.7/18.7/70.5
 * Petropavlovsk-Kamchatsky=-45.0/1.9/52.7
 * Philadelphia=-36.8/13.2/62.4
 * Phnom Penh=-19.6/28.3/76.9
 * Phoenix=-25.8/23.9/79.0
 * Pittsburgh=-41.5/10.8/62.8
 * Podgorica=-35.2/15.3/65.3
 * Pointe-Noire=-21.9/26.1/81.3
 * Pontianak=-22.6/27.7/78.3
 * Port Moresby=-24.2/26.9/81.9
 * Port Sudan=-26.9/28.4/78.9
 * Port Vila=-31.0/24.3/75.8
 * Port-Gentil=-26.9/26.0/76.5
 * Portland (OR)=-38.8/12.4/62.1
 * Porto=-37.5/15.7/62.7
 * Prague=-43.5/8.4/57.7
 * Praia=-24.6/24.4/75.4
 * Pretoria=-30.8/18.2/64.2
 * Pyongyang=-47.4/10.8/59.6
 * Rabat=-33.9/17.2/66.0
 * Rangpur=-24.5/24.4/76.7
 * Reggane=-20.4/28.3/78.0
 * Reykjavík=-45.0/4.3/52.0
 * Riga=-42.7/6.2/55.4
 * Riyadh=-23.9/26.0/73.5
 * Rome=-33.1/15.2/63.0
 * Roseau=-25.3/26.2/78.0
 * Rostov-on-Don=-46.1/9.9/58.4
 * Sacramento=-33.1/16.3/63.9
 * Saint Petersburg=-46.9/5.8/56.0
 * Saint-Pierre=-44.7/5.7/53.9
 * Salt Lake City=-37.2/11.6/63.0
 * San Antonio=-28.4/20.8/71.5
 * San Diego=-35.4/17.8/68.4
 * San Francisco=-34.8/14.6/65.2
 * San Jose=-36.2/16.4/68.1
 * San José=-24.7/22.6/79.4
 * San Juan=-19.7/27.2/75.9
 * San Salvador=-31.4/23.1/69.9
 * Sana'a=-30.8/20.0/68.2
 * Santo Domingo=-25.0/25.9/74.6
 * Sapporo=-38.2/8.9/59.3
 * Sarajevo=-39.3/10.1/59.3
 * Saskatoon=-46.6/3.3/52.6
 * Seattle=-42.2/11.3/60.7
 * Seoul=-38.0/12.5/61.6
 * Seville=-26.7/19.2/68.7
 * Shanghai=-30.7/16.7/64.3
 * Singapore=-24.1/27.0/74.6
 * Skopje=-40.9/12.4/63.1
 * Sochi=-35.8/14.2/65.7
 * Sofia=-38.6/10.6/63.4
 * Sokoto=-22.5/28.0/79.1
 * Split=-41.0/16.1/65.8
 * St. John's=-42.7/5.0/53.7
 * St. Louis=-34.8/13.9/63.5
 * Stockholm=-42.3/6.6/57.3
 * Surabaya=-22.1/27.1/81.5
 * Suva=-27.6/25.6/73.8
 * Suwałki=-43.6/7.2/54.9
 * Sydney=-32.3/17.7/68.9
 * Ségou=-22.2/28.0/79.3
 * Tabora=-25.9/23.0/75.5
 * Tabriz=-37.7/12.6/66.4
 * Taipei=-26.4/23.0/72.6
 * Tallinn=-45.4/6.4/56.6
 * Tamale=-23.7/27.9/75.0
 * Tamanrasset=-27.4/21.7/70.9
 * Tampa=-29.4/22.9/72.4
 * Tashkent=-35.2/14.8/63.2
 * Tauranga=-35.3/14.8/66.2
 * Tbilisi=-35.3/12.9/60.9
 * Tegucigalpa=-28.1/21.7/75.9
 * Tehran=-31.6/17.0/63.8
 * Tel Aviv=-34.5/20.0/70.0
 * Thessaloniki=-36.9/16.0/65.2
 * Thiès=-23.9/24.0/76.4
 * Tijuana=-29.9/17.8/68.6
 * Timbuktu=-24.0/28.0/76.4
 * Tirana=-37.0/15.2/69.3
 * Toamasina=-28.4/23.4/71.7
 * Tokyo=-36.4/15.4/65.1
 * Toliara=-25.3/24.1/82.6
 * Toluca=-40.6/12.4/63.6
 * Toronto=-39.8/9.4/60.3
 * Tripoli=-33.3/20.0/70.6
 * Tromsø=-49.0/2.9/53.0
 * Tucson=-30.7/20.9/72.7
 * Tunis=-34.1/18.4/72.3
 * Ulaanbaatar=-47.7/-0.4/50.5
 * Upington=-33.2/20.4/70.0
 * Vaduz=-40.2/10.1/60.4
 * Valencia=-35.8/18.3/68.7
 * Valletta=-34.1/18.8/72.7
 * Vancouver=-38.6/10.4/61.9
 * Veracruz=-23.2/25.4/80.1
 * Vienna=-42.6/10.4/60.2
 * Vientiane=-24.5/25.9/80.4
 * Villahermosa=-22.8/27.1/74.8
 * Vilnius=-42.0/6.0/53.6
 * Virginia Beach=-38.3/15.8/65.9
 * Vladivostok=-45.3/4.9/56.3
 * Warsaw=-39.6/8.5/57.3
 * Washington, D.C.=-36.7/14.6/64.8
 * Wau=-19.7/27.8/76.6
 * Wellington=-36.2/12.9/62.7
 * Whitehorse=-50.6/-0.1/49.1
 * Wichita=-33.8/13.9/62.5
 * Willemstad=-22.5/28.0/76.2
 * Winnipeg=-44.8/3.0/53.3
 * Wrocław=-42.1/9.6/68.6
 * Xi'an=-38.7/14.1/64.3
 * Yakutsk=-59.6/-8.8/40.1
 * Yangon=-28.2/27.5/75.5
 * Yaoundé=-26.8/23.8/74.1
 * Yellowknife=-54.4/-4.3/46.4
 * Yerevan=-38.3/12.4/65.9
 * Yinchuan=-41.3/9.0/61.9
 * Zagreb=-41.0/10.7/61.3
 * Zanzibar City=-22.7/26.0/77.0
 * Zürich=-39.6/9.3/55.8
 * Ürümqi=-44.6/7.4/56.4
 * İzmir=-29.0/17.9/69.1
 * The challenge contains 1000000000 rows, parsed and processed in 197 seconds.
 * 
 */
